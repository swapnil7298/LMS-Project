{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<section class="dashboard-section">
    <div class="container">
        <div class="dashboard-header">
            <h1>Welcome, {{ session.username }}!</h1>
            {% if session.role == 'student' %}
            <p>Here are your upcoming deadlines and quick actions.</p>
            {% elif session.role == 'teacher' %}
            <p>Here are your recent submissions and quick actions.</p>
            {% else %}
            <p>This is your central hub for learning and teaching.</p>
            {% endif %}
        </div>

        <div class="dynamic-dashboard-grid">
            <div class="dashboard-main-actions">
                <a href="{{ url_for('my_courses') }}" class="dashboard-card">
                    <div class="card-icon"><i class="fas fa-book-open"></i></div>
                    <div class="card-content">
                        <h3>My Courses</h3>
                        <p>View and manage all your courses.</p>
                    </div>
                </a>
                 <a href="{{ url_for('messages') }}" class="dashboard-card">
                    <div class="card-icon"><i class="fas fa-comments"></i></div>
                    <div class="card-content">
                        <h3>Messages</h3>
                        <p>View your conversations.</p>
                    </div>
                </a>
                <a href="{{ url_for('performance') }}" class="dashboard-card">
                    <div class="card-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="card-content">
                        <h3>Performance</h3>
                        <p>Track your learning progress and stats.</p>
                    </div>
                </a>
                <a href="{{ url_for('settings') }}" class="dashboard-card">
                    <div class="card-icon"><i class="fas fa-cog"></i></div>
                    <div class="card-content">
                        <h3>Account Settings</h3>
                        <p>Manage your profile and password.</p>
                    </div>
                </a>
            </div>

            <div class="dashboard-context-panel">
                {% if session.role == 'student' %}
                <div class="context-card">
                    <h4><i class="fas fa-clock"></i> Upcoming Deadlines</h4>
                    <div class="context-list">
                        {% for asn in data.upcoming_assignments %}
                        <div class="context-item">
                            <a href="{{ url_for('course_detail', course_id=asn.course_id) }}">{{ asn.title }}</a>
                            <span class="context-meta">Due: {{ asn.due_date.strftime('%d %b') }} in "{{ asn.course_title }}"</span>
                        </div>
                        {% endfor %}
                        {% if not data.upcoming_assignments %}
                        <p class="text-muted">No upcoming deadlines. Great job!</p>
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                {% if session.role == 'teacher' %}
                <div class="context-card">
                    <h4><i class="fas fa-inbox"></i> Needs Grading</h4>
                    <div class="context-list">
                        {% for sub in data.pending_submissions %}
                        <div class="context-item">
                            <a href="{{ url_for('view_submissions', assignment_id=sub.assignment_id) }}">{{ sub.assignment_title }}</a>
                            <span class="context-meta">Submitted by {{ sub.student_name }} on {{ sub.submitted_at.strftime('%d %b') }}</span>
                        </div>
                        {% endfor %}
                        {% if not data.pending_submissions %}
                        <p class="text-muted">No pending submissions to grade.</p>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}